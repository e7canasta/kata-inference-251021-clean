# Test Cases Funcionales - Sistema Detecci√≥n Ca√≠das Adeline
## Documento para Testing de Campo con Actores

**Versi√≥n:** 1.0
**Fecha:** 2025-10-22
**Sistema:** Adeline v2.1 (con IoU Multi-Object Tracking)
**Contexto:** Residencias geri√°tricas - Habitaciones compartidas (1-4 residentes)
**Duraci√≥n estimada:** 1 d√≠a completo (6-8 horas efectivas)

---



## TEST CASES 


  ---
  üß™ Testing Manual - Escenario Multi-Persona

  Para testear el IoU matching en habitaciones compartidas:

  Escenario de Test

  Setup: Habitaci√≥n con 2-4 personas (residentes + enfermeros/visitantes)

  Test Cases Cr√≠ticos:

  1. Personas est√°ticas (en camas)
    - Esperado: Cada persona mantiene su propio track ID
    - Antes (sin IoU): Pod√≠an confundirse si desaparec√≠a una persona
  2. Persona caminando + persona en cama
    - Esperado: Tracks separados, no se confunden
    - Antes: Cuando persona A sale, persona B pod√≠a "robar" el track de A
  3. Cruce de personas (enfermero pasa cerca de residente)
    - Esperado: Tracks se mantienen separados si IoU < 0.3
    - Cr√≠tico: Verificar que no se fusionan tracks cuando se cruzan
  4. Oclusi√≥n parcial
    - Esperado: Track se mantiene si reaparece dentro de max_gap frames
    - Verificar que el re-match usa IoU correctamente


---




‚úÖ Implementaci√≥n completa + documento realista de testing

  ---
  üì¶ Resumen de Entregables

  ‚úÖ 1. IoU Matching Implementado (v2.1)

  Archivos modificados:
  ‚úÖ inference/stabilization/core.py        - calculate_iou() + matching espacial
  ‚úÖ config.py                               - STABILIZATION_IOU_THRESHOLD
  ‚úÖ inference/factories/strategy_factory.py - Pasa iou_threshold
  ‚úÖ PLAN_MEJORAS.md                         - Status actualizado
  ‚úÖ CLAUDE.md                               - Testing strategy actualizada

  Compilaci√≥n verificada:
  python -m py_compile inference/stabilization/core.py      # ‚úÖ
  python -m py_compile config.py                            # ‚úÖ
  python -m py_compile inference/factories/strategy_factory.py  # ‚úÖ

  ---
  ‚úÖ 2. Documento TEST_CASES_FUNCIONALES.md

  Tipo: Script de filmaci√≥n para testing de campo con actores

  Contenido (actualizado a realidad Adeline v2.1):

  ‚ö† Cambio clave: Documento ahora es honesto sobre alcance:
  - ‚úÖ Valida: Multi-tracking IoU (2-4 personas), track stability, bbox changes
  - ‚ùå NO valida: Eventos espec√≠ficos (Bed Exit, Bathroom Timer, etc.) ‚Üí Requiere v3.0+

  Escenarios (12 test cases):
  CATEGOR√çA 1: Baseline (1 persona)
    TC-001: Persona est√°tica en cama
    TC-002: Persona con movimiento
    TC-003: Cambio de postura (fundamento para ca√≠da) ‚¨Ö Reframed

  CATEGOR√çA 2: Habitaci√≥n doble (2 personas)
    TC-004: Dos residentes est√°ticos
    TC-005: Enfermero entra/sale
    TC-006: Cambio de postura R1 con R2 en cama ‚≠ê CR√çTICO ‚¨Ö Reframed
    TC-007: Cruce de personas

  CATEGOR√çA 3: Habitaci√≥n compartida (3-4 personas)
    TC-008: Cuatro residentes (stress test)
    TC-009: Cambio postura con 4 personas ‚≠ê‚≠ê‚≠ê M√ÅS CR√çTICO ‚¨Ö Reframed

  CATEGOR√çA 4: Edge Cases
    TC-010: Oclusi√≥n temporal
    TC-011: Entrada/salida r√°pida
    TC-012: Variaci√≥n de luz

  Lo nuevo:
  - Secci√≥n inicial: "Lo que v2.1 PUEDE vs NO PUEDE hacer"
  - Test cases reframed: Validan fundamentos de tracking, no eventos espec√≠ficos
  - Criterios de √©xito realistas
  - Roadmap hacia v3.0 con:
    - Tabla de viabilidad de eventos Verso Vision
    - Ejemplo de c√≥digo PatientFallHandler (para v3.0)
    - KISS approach para event detection layer
    - Preguntas para planificaci√≥n v3.0

  ---
  üéØ Objetivo del Testing de Campo

  Validar: ¬øEl IoU matching permite distinguir qui√©n es qui√©n en habitaciones compartidas?

  Pregunta cr√≠tica (TC-009):
  "Con 4 personas en habitaci√≥n, si una cambia de postura (cae), ¬øpodemos identificar cu√°l de los 4 tracks cambi√≥?"

  Si la respuesta es S√ç:
  ‚Üí Fundamento validado
  ‚Üí v2.1 es production-ready
  ‚Üí Pasar a v3.0 (agregar event detection layer)

  Si la respuesta es NO:
  ‚Üí Ajustar par√°metros (iou_threshold, min_frames)
  ‚Üí Posible debugging de matching logic

  ---
  üìã Pr√≥ximos Pasos

  1. Testing de Campo (Fin de Semana)

  Preparaci√≥n:
  - Imprimir TEST_CASES_FUNCIONALES.md
  - Equipo de actores (4 personas + operador t√©cnico)
  - Equipamiento: C√°mara RTSP, laptop, colchonetas seguridad
  - Residencia real (habitaci√≥n 2-4 camas)

  Ejecuci√≥n:
  - Seguir scripts TC-001 a TC-012
  - Operador t√©cnico registra:
    - Logs MQTT (track IDs, bbox dimensions)
    - Videos de cada escenario
    - Observaciones (fusiones, swaps, resets)

  Validaci√≥n:
  - Completar matriz de validaci√≥n final
  - Llenar checklist de cada test case
  - Focus en TC-006 y TC-009 (cr√≠ticos)

  2. An√°lisis de Resultados

  Si ‚â•10/12 tests aprobados:
  ‚Üí v2.1 ‚úÖ VALIDADA
  ‚Üí Reuni√≥n planificaci√≥n v3.0 (eventos)

  Si 8-9/12 tests aprobados:
  ‚Üí Ajustar par√°metros
  ‚Üí Re-test casos fallidos

  Si <8/12 tests aprobados:
  ‚Üí Debugging IoU matching
  ‚Üí Revisar implementaci√≥n

  3. Planificaci√≥n v3.0 (Event Detection)

  Despu√©s de validar v2.1:
  - Revisar tabla de eventos Verso Vision en documento
  - Priorizar eventos (Patient Fall, Extra Person, etc.)
  - Definir precisi√≥n m√≠nima requerida (90%? 95%?)
  - Evaluar si se necesita pose estimation

  Orden sugerido v3.0:
  Sprint 1: Extra Person In Room    (1-2 d√≠as - conteo tracks)
  Sprint 2: Patient Fall             (3-5 d√≠as - aspect ratio)
  Sprint 3: Room Exit                (3-5 d√≠as - zones)
  Sprint 4: Bathroom Timer           (3-5 d√≠as - zones + time)

  ---
  üß† Filosof√≠a Mantenida: KISS + Complejidad por Dise√±o

  Lo que hicimos en v2.1:
  - IoU matching ‚Üê Complejidad donde importa (distinguir objetos)
  - KISS en implementaci√≥n (best-match by IoU, simple)
  - Factory pattern (consistente con arquitectura)

  Lo que viene en v3.0:
  - Event detection ‚Üê Nueva capa de complejidad
  - KISS en l√≥gica (aspect ratio, zones, conteo - no ML complicado)
  - Un handler por evento (SRP)
  - Factory pattern (igual que stabilization)

  NO vamos a:
  - Sobrecomplicar con ML pesado (pose estimation solo si es cr√≠tico)
  - Implementar todos los eventos de golpe
  - Prometer features antes de validar fundamentos

  ---
  üìÑ Documentos Actualizados

  ‚úÖ TEST_CASES_FUNCIONALES.md  - 870 l√≠neas, script completo de testing
  ‚úÖ PLAN_MEJORAS.md             - Tarea 1 marcada como implementada
  ‚úÖ CLAUDE.md                   - Testing strategy actualizada
  ‚úÖ C√≥digo fuente              - IoU matching functional

  ---


---

## üé¨ Informaci√≥n General del Testing

### Contexto del Sistema

**Adeline v2.1** es un sistema de **person detection + tracking multi-objeto** dise√±ado como **base** para sistemas de monitoreo geri√°trico (tipo Verso Vision).

**‚ö†Ô∏è IMPORTANTE - Alcance de esta versi√≥n:**

**‚úÖ Lo que Adeline v2.1 PUEDE hacer (y vamos a validar):**
- Detectar personas en tiempo real (YOLO-based)
- **Tracking multi-persona con IoU matching** (‚¨ÖÔ∏è NUEVO, objetivo de este testing)
- Diferenciar qui√©n es qui√©n en habitaciones compartidas (2-4 personas)
- Mantener track IDs estables
- Detectar cambios en bounding box (puede sugerir ca√≠da, cambio de postura)
- Contar personas en habitaci√≥n ("Extra Person In Room" b√°sico)

**‚ùå Lo que Adeline v2.1 NO PUEDE hacer todav√≠a (requiere v3.0+):**
- Eventos espec√≠ficos (Bed Exit, Bathroom Timer, Leaving Chair) ‚Üí Requiere zone detection + event logic
- Pose estimation (sitting vs standing vs laying) ‚Üí Requiere pose detection model
- Bathroom Entry/Timer ‚Üí Requiere zone tracking
- Out of View logic ‚Üí Requiere spatial reasoning

**üéØ Objetivo de este Testing:**

Validar el **fundamento de tracking multi-persona** que permitir√° implementar eventos espec√≠ficos en futuras versiones:

1. **Tracking multi-persona estable** (nuevo IoU matching)
2. **Identificaci√≥n de qui√©n es qui√©n** en habitaciones compartidas
3. **Persistencia de tracks** con oclusiones, movimientos, entradas/salidas
4. **Base para eventos futuros** (si podemos distinguir tracks, luego podemos agregar zone logic)

### Setup T√©cnico Requerido

**Hardware:**
- C√°mara RTSP configurada (altura: 2.5-3m, √°ngulo: 30-45¬∞ hacia abajo)
- Laptop con sistema Adeline corriendo
- Monitor para visualizaci√≥n en tiempo real
- Red WiFi estable

**Software (debe estar corriendo):**
```bash
# Terminal 1: Pipeline principal
python -m adeline

# Terminal 2: Monitor de detecciones (para validaci√≥n)
python -m adeline.data.monitors data

# Terminal 3: Monitor de status
python -m adeline.data.monitors status
```

**Configuraci√≥n cr√≠tica (config.yaml):**
```yaml
detection_stabilization:
  mode: temporal
  iou:
    threshold: 0.3  # ‚¨ÖÔ∏è CR√çTICO para multi-persona
```

### Equipo Requerido

**Roles de Actores:**
- **Residente 1 (R1):** Persona de edad avanzada, movilidad reducida
- **Residente 2 (R2):** Persona de edad avanzada, movilidad moderada
- **Residente 3 (R3):** Persona de edad avanzada (solo para escenarios 4 residentes)
- **Residente 4 (R4):** Persona de edad avanzada (solo para escenarios 4 residentes)
- **Enfermero/a (E):** Staff m√©dico, movilidad normal
- **Visitante (V):** Familiar o visitante, movilidad normal
- **Operador T√©cnico (OT):** Observa monitors, registra resultados

**Materiales de Escenograf√≠a:**
- 2-4 camas tipo hospital
- Sillas
- Mesa auxiliar
- Andador (opcional)
- Colchonetas de seguridad (para simular ca√≠das)

---

## üìã Escenarios de Test

### Categor√≠as de Escenarios

1. **Baseline (1 persona)** - Validaci√≥n b√°sica
2. **Habitaci√≥n doble (2 personas)** - Caso m√°s com√∫n
3. **Habitaci√≥n compartida (3-4 personas)** - Caso complejo
4. **Oclusiones y cruces** - Edge cases cr√≠ticos
5. **Ca√≠das con m√∫ltiples personas** - Objetivo principal

---

## üîµ CATEGOR√çA 1: Baseline (1 Persona)

### TC-001: Persona sola est√°tica en cama

**Objetivo:** Verificar tracking b√°sico de 1 persona sin movimiento

**Actores:** R1

**Precondiciones:**
- Sistema corriendo
- Habitaci√≥n vac√≠a inicialmente

**Script:**
1. R1 entra en la habitaci√≥n (00:00)
2. R1 se acuesta en la cama (00:10)
3. R1 permanece acostado sin moverse (00:15 - 02:00)
4. R1 se levanta y sale (02:00)

**Resultado Esperado:**
- ‚úÖ 1 track de "person" activo entre 00:10 - 02:00
- ‚úÖ Track se mantiene estable (no parpadea)
- ‚úÖ Track desaparece despu√©s de que R1 sale (dentro de 2-3 frames)

**Checklist de Validaci√≥n:**
```
[ ] Track aparece en < 3 segundos despu√©s de entrar
[ ] No hay tracks duplicados (solo 1 track activo)
[ ] Track no se pierde durante los 2 minutos acostado
[ ] Track se elimina correctamente al salir
[ ] Monitor muestra confidence >= 0.3
```

---

### TC-002: Persona sola con movimiento en habitaci√≥n

**Objetivo:** Verificar tracking de 1 persona en movimiento

**Actores:** R1

**Script:**
1. R1 entra en la habitaci√≥n (00:00)
2. R1 camina hacia la ventana (00:05)
3. R1 se sienta en silla (00:20)
4. R1 se levanta y camina hacia la cama (00:40)
5. R1 se acuesta (01:00)
6. R1 permanece acostado (01:00 - 02:00)

**Resultado Esperado:**
- ‚úÖ 1 track √∫nico se mantiene durante todo el recorrido
- ‚úÖ No se crean m√∫ltiples tracks para la misma persona
- ‚úÖ Bounding box se actualiza correctamente al moverse

**Checklist de Validaci√≥n:**
```
[ ] Mismo track ID durante todo el recorrido (no se resetea)
[ ] Track no se pierde durante transiciones (parado ‚Üí sentado ‚Üí acostado)
[ ] Bounding box refleja la posici√≥n real
[ ] No hay "saltos" del track (tracking suave)
```

---

### TC-003: Cambio de postura (persona al suelo)

**Objetivo:** Verificar que el tracking persiste durante cambios dr√°sticos de postura (fundamento para futura detecci√≥n de ca√≠das)

**Actores:** R1

**‚ö†Ô∏è SEGURIDAD:** Usar colchoneta de seguridad

**‚ö†Ô∏è NOTA:** Este test valida tracking, NO detecci√≥n de ca√≠da espec√≠fica (v3.0+)

**Script:**
1. R1 entra y camina al centro de la habitaci√≥n (00:00)
2. R1 permanece de pie 10 segundos (00:10)
3. **R1 simula ca√≠da controlada al suelo** (00:20) ‚¨ÖÔ∏è Cambio dr√°stico de postura
4. R1 permanece en el suelo 30 segundos (00:20 - 00:50)
5. R1 se levanta (00:50)
6. R1 sale de la habitaci√≥n (01:00)

**Resultado Esperado:**
- ‚úÖ Track se mantiene durante todo el escenario (mismo ID)
- ‚úÖ Bounding box cambia de aspect ratio (vertical ‚Üí horizontal al caer)
- ‚úÖ Sistema sigue detectando "person" mientras est√° en el suelo
- ‚úÖ Logs MQTT muestran cambio en dimensiones del bbox

**Checklist de Validaci√≥n:**
```
[ ] Track existe antes, durante y despu√©s (mismo ID)
[ ] Track no se pierde durante la ca√≠da
[ ] Bounding box cambia dimensiones (height > width ‚Üí width > height)
[ ] Detection persiste mientras R1 est√° en el suelo (conf >= 0.3)
[ ] MQTT muestra bbox con nuevo aspect ratio
```

**üîç Observaci√≥n para v3.0:**
```
Este test captura datos para futura l√≥gica de eventos:
- bbox.height / bbox.width antes: ~1.5-2.0 (persona de pie)
- bbox.height / bbox.width despu√©s: ~0.5-0.8 (persona en suelo)
‚Üí Fundamento para "Patient Fall" event detection
```

---

## üü¢ CATEGOR√çA 2: Habitaci√≥n Doble (2 Personas)

### TC-004: Dos residentes est√°ticos en camas separadas

**Objetivo:** Verificar tracking de 2 personas sin movimiento (IoU baseline)

**Actores:** R1, R2

**Precondiciones:**
- 2 camas separadas ~2 metros

**Script:**
1. R1 entra y se acuesta en cama 1 (00:00)
2. R2 entra y se acuesta en cama 2 (00:30)
3. Ambos permanecen acostados (01:00 - 03:00)
4. R1 se levanta y sale (03:00)
5. R2 permanece acostado (03:00 - 04:00)
6. R2 se levanta y sale (04:00)

**Resultado Esperado:**
- ‚úÖ 2 tracks separados (no se confunden)
- ‚úÖ Track de R1 desaparece al salir (~03:02)
- ‚úÖ Track de R2 se mantiene solo despu√©s de que R1 sale
- ‚úÖ No hay "robo" de track (R2 no toma el track de R1)

**Checklist de Validaci√≥n:**
```
[ ] 2 tracks activos entre 01:00 - 03:00
[ ] Tracks no se fusionan (IoU < 0.3)
[ ] Track R1 se elimina correctamente al salir
[ ] Track R2 no se resetea cuando R1 sale
[ ] Monitor muestra 2 ‚Üí 1 ‚Üí 0 tracks en secuencia correcta
```

---

### TC-005: Enfermero entra/sale con residente en cama

**Objetivo:** Verificar que entrada/salida de staff no afecta track de residente

**Actores:** R1, E

**Script:**
1. R1 entra y se acuesta en cama (00:00)
2. R1 permanece acostado (00:30 - 03:00)
3. E entra en la habitaci√≥n (01:00) ‚¨ÖÔ∏è **Nuevo track**
4. E camina hacia la cama de R1 (01:10)
5. E revisa a R1 (se acerca, IoU temporal alto) (01:20)
6. E camina hacia la puerta (01:40)
7. E sale de la habitaci√≥n (01:50) ‚¨ÖÔ∏è **Track desaparece**
8. R1 contin√∫a acostado (02:00 - 03:00)

**Resultado Esperado:**
- ‚úÖ Track R1 se mantiene estable durante toda la secuencia
- ‚úÖ Track E aparece al entrar (~01:02)
- ‚úÖ Tracks R1 y E se mantienen separados (incluso cuando E est√° cerca)
- ‚úÖ Track E desaparece al salir (~01:52)
- ‚úÖ Track R1 no se resetea despu√©s de la visita

**Checklist de Validaci√≥n:**
```
[ ] Track R1 existe antes, durante y despu√©s de la visita (sin reseteo)
[ ] Track E aparece solo cuando entra
[ ] Tracks no se fusionan cuando E est√° cerca de R1
[ ] Track E se elimina correctamente al salir
[ ] Monitor muestra 1 ‚Üí 2 ‚Üí 1 tracks en secuencia correcta
```

---

### TC-006: Cambio de postura R1 con R2 en cama (CR√çTICO - Multi-Tracking)

**Objetivo:** Verificar que el sistema puede distinguir qu√© track cambi√≥ de postura cuando hay 2 personas

**Actores:** R1, R2

**‚ö†Ô∏è SEGURIDAD:** Usar colchoneta

**‚ö†Ô∏è NOTA:** Valida multi-tracking, NO evento "Patient Fall" espec√≠fico (v3.0+)

**Script:**
1. R1 entra y se acuesta en cama 1 (00:00)
2. R2 entra y se acuesta en cama 2 (00:30)
3. Ambos permanecen acostados (01:00)
4. **R1 se levanta** (01:30)
5. **R1 simula ca√≠da al suelo** (01:40) ‚¨ÖÔ∏è **CR√çTICO - ¬øSistema distingue qu√© track cambi√≥?**
6. R1 permanece en el suelo (01:40 - 02:30)
7. R2 permanece acostado durante todo el escenario
8. E entra para ayudar a R1 (02:30)

**Resultado Esperado:**
- ‚úÖ Sistema mantiene 2 tracks separados e independientes (R1, R2)
- ‚úÖ Solo el track R1 cambia bounding box (aspect ratio vertical ‚Üí horizontal)
- ‚úÖ Track R2 permanece estable (no afectado por R1)
- ‚úÖ **Operador puede identificar en MQTT qu√© track cambi√≥** (R1 vs R2)
- ‚úÖ Track R1 persiste mientras est√° en el suelo (mismo ID)
- ‚úÖ Track E aparece al entrar (3 tracks, diferenciados por IoU)

**Checklist de Validaci√≥n:**
```
[ ] 2 tracks activos y separados entre 01:00 - 01:30
[ ] Track R1 cambia aspect ratio al caer (observado en MQTT/logs)
[ ] Track R2 NO cambia dimensiones (permanece estable)
[ ] Operador puede identificar QU√â track cambi√≥ (mediante ID o posici√≥n)
[ ] Track R1 mantiene mismo ID antes/despu√©s de caer
[ ] Track E aparece correctamente (3 tracks simult√°neos, no confundidos)
```

**‚≠ê VERIFICACI√ìN CR√çTICA:**
```
Pregunta: "Observando logs MQTT, ¬øse puede identificar cu√°l de los 2 tracks cambi√≥ de postura?"

[ ] S√≠ - Track IDs estables + cambio de bbox observable ‚Üí √âxito ‚úÖ
[ ] No - Tracks se confunden o resetean ‚Üí Falla cr√≠tica ‚ùå
```

**üîç Observaci√≥n para v3.0:**
```
Este test valida el fundamento de IoU multi-tracking que permite:
- Diferenciar Track_A (cambi√≥ bbox) vs Track_B (estable)
- Futura l√≥gica: IF track.aspect_ratio cambi√≥ + track.y_center aument√≥ ‚Üí Patient Fall
- Futura l√≥gica: IF extra_track aparece + room.count == 2 ‚Üí Extra Person In Room
```

---

### TC-007: Cruce de personas (enfermero pasa cerca de residente)

**Objetivo:** Verificar que tracks no se fusionan al cruzarse

**Actores:** R1, E

**Script:**
1. R1 camina lentamente por el lado derecho de la habitaci√≥n (00:00)
2. E entra por el lado izquierdo (00:10)
3. **R1 y E se cruzan en el centro** (00:20) ‚¨ÖÔ∏è IoU alto temporal
4. Contin√∫an caminando en direcciones opuestas (00:25)
5. R1 sale por la izquierda (00:40)
6. E sale por la derecha (00:50)

**Resultado Esperado:**
- ‚úÖ Tracks se mantienen separados durante el cruce
- ‚úÖ No hay "swap" de tracks (R1 no se convierte en E despu√©s del cruce)
- ‚úÖ Cada track mantiene su trayectoria correcta

**Checklist de Validaci√≥n:**
```
[ ] 2 tracks activos durante todo el escenario
[ ] Tracks no se fusionan en el cruce (IoU threshold funciona)
[ ] No hay swap de IDs despu√©s del cruce
[ ] Bounding boxes reflejan correctamente cada persona
```

---

## üü° CATEGOR√çA 3: Habitaci√≥n Compartida (3-4 Personas)

### TC-008: Cuatro residentes en habitaci√≥n compartida (Stress Test)

**Objetivo:** Verificar tracking de 4 personas simult√°neas (caso extremo de IoU matching)

**Actores:** R1, R2, R3, R4

**Precondiciones:**
- 4 camas en habitaci√≥n

**Script:**
1. R1 entra y se acuesta en cama 1 (00:00)
2. R2 entra y se acuesta en cama 2 (00:30)
3. R3 entra y se acuesta en cama 3 (01:00)
4. R4 entra y se acuesta en cama 4 (01:30)
5. Los 4 permanecen acostados (02:00 - 05:00)
6. R3 se levanta, camina y sale (05:00)
7. Los otros 3 permanecen acostados (05:30 - 07:00)

**Resultado Esperado:**
- ‚úÖ Sistema mantiene 4 tracks separados
- ‚úÖ Tracks no se fusionan ni duplican
- ‚úÖ Track R3 desaparece correctamente al salir
- ‚úÖ Los otros 3 tracks permanecen estables

**Checklist de Validaci√≥n:**
```
[ ] Monitor muestra 1 ‚Üí 2 ‚Üí 3 ‚Üí 4 tracks en secuencia
[ ] 4 tracks activos estables entre 02:00 - 05:00
[ ] No hay tracks duplicados (verificar en MQTT)
[ ] Track R3 se elimina al salir (4 ‚Üí 3 tracks)
[ ] Tracks restantes no se resetean
```

---

### TC-009: Cambio de postura en habitaci√≥n con 4 personas (CR√çTICO M√ÅXIMO)

**Objetivo:** Verificar que el sistema puede distinguir qu√© track cambi√≥ en el escenario m√°s complejo (4 personas)

**Actores:** R1, R2, R3, R4

**‚ö†Ô∏è SEGURIDAD:** Usar colchoneta

**‚ö†Ô∏è NOTA:** Valida IoU multi-tracking (4 personas), NO evento espec√≠fico (v3.0+)

**Script:**
1. R1, R2 acostados en camas (00:00)
2. R3, R4 acostados en camas (00:00)
3. Todos permanecen 2 minutos (00:00 - 02:00)
4. **R3 se levanta** (02:00)
5. R3 camina hacia el centro (02:10)
6. **R3 simula ca√≠da controlada** (02:20) ‚¨ÖÔ∏è **CR√çTICO - ¬øSistema distingue 1 de 4 tracks?**
7. R3 permanece en el suelo (02:20 - 03:00)
8. R1, R2, R4 permanecen en camas durante todo el escenario

**Resultado Esperado:**
- ‚úÖ Sistema mantiene 4 tracks separados y estables (IoU funciona con 4 objetos)
- ‚úÖ Solo el track R3 cambia bounding box (aspect ratio)
- ‚úÖ Tracks R1, R2, R4 permanecen estables (no afectados)
- ‚úÖ **Operador puede identificar en MQTT cu√°l de los 4 tracks cambi√≥**
- ‚úÖ No hay confusi√≥n de track IDs (no swaps durante 4-person tracking)

**Checklist de Validaci√≥n:**
```
[ ] 4 tracks activos y diferenciados entre 02:00 - 02:10
[ ] Solo track R3 cambia aspect ratio (observable en logs/MQTT)
[ ] Tracks R1, R2, R4 NO cambian dimensiones
[ ] Operador puede identificar QU√â track de los 4 cambi√≥
[ ] No hay swaps de track IDs durante el escenario
[ ] IoU threshold (0.3) es suficiente para 4 personas en habitaci√≥n
```

**‚≠ê‚≠ê‚≠ê VERIFICACI√ìN CR√çTICA:**
```
Pregunta: "Observando logs MQTT con 4 tracks activos, ¬øse puede identificar cu√°l cambi√≥ de postura?"

[ ] S√≠ - 4 tracks estables + cambio de bbox identificable ‚Üí √âxito ‚úÖ‚úÖ‚úÖ
[ ] No - Tracks se confunden, resetean o fusionan ‚Üí Falla cr√≠tica ‚ùå‚ùå‚ùå

Esto valida el objetivo principal de v2.1: IoU matching funciona en escenarios realistas complejos.
```

**üîç Observaci√≥n para v3.0:**
```
Este test es el fundamento para todos los eventos de Verso Vision:
- Si IoU puede diferenciar 4 personas ‚Üí Podemos agregar zone logic
- Si track IDs son estables ‚Üí Podemos trackear "Bed Exit" per-resident
- Si cambio de bbox es observable ‚Üí Podemos detectar "Patient Fall"
- Si contamos tracks ‚Üí Podemos detectar "Extra Person In Room"

v2.1 valida el fundamento. v3.0+ agregar√° event detection layer.
```

---

## üü† CATEGOR√çA 4: Edge Cases y Oclusiones

### TC-010: Oclusi√≥n temporal (persona pasa detr√°s de mueble)

**Objetivo:** Verificar persistencia de track durante oclusi√≥n breve

**Actores:** R1

**Precondiciones:**
- Mueble o biombo que genere oclusi√≥n

**Script:**
1. R1 camina por la habitaci√≥n (00:00)
2. **R1 pasa detr√°s del mueble** (oclusi√≥n total) (00:10 - 00:15)
3. R1 reaparece del otro lado (00:15)
4. R1 contin√∫a caminando (00:20)

**Resultado Esperado:**
- ‚úÖ Track se mantiene durante oclusi√≥n (gracias a `max_gap=2`)
- ‚úÖ No se crea nuevo track al reaparecer
- ‚úÖ Mismo track ID antes, durante y despu√©s

**Checklist de Validaci√≥n:**
```
[ ] Track no se elimina durante oclusi√≥n (<2 frames sin detecci√≥n)
[ ] No se crea track duplicado al reaparecer
[ ] Bounding box reaparece en posici√≥n correcta
```

---

### TC-011: Entrada/salida r√°pida (enfermero asoma cabeza)

**Objetivo:** Verificar que detecciones breves no generan tracks espurios

**Actores:** E

**Script:**
1. Habitaci√≥n vac√≠a (00:00)
2. E asoma la cabeza por la puerta (1 segundo) (00:05 - 00:06)
3. E desaparece (00:06)
4. Pausa 5 segundos (00:06 - 00:11)
5. E asoma nuevamente (1 segundo) (00:11 - 00:12)
6. E desaparece (00:12)

**Resultado Esperado:**
- ‚úÖ No se crea track confirmado (< `min_frames=3`)
- ‚úÖ Sistema ignora detecciones espor√°dicas
- ‚úÖ Monitor muestra "ignored" o "tracking" pero no "confirmed"

**Checklist de Validaci√≥n:**
```
[ ] No hay tracks confirmados (requiere 3 frames consecutivos)
[ ] Monitor no muestra false positives
[ ] Logs indican "tracking" pero no "confirmed"
```

---

### TC-012: Variaci√≥n de luz (cortina se cierra/abre)

**Objetivo:** Verificar robustez ante cambios de iluminaci√≥n

**Actores:** R1, E

**Script:**
1. R1 acostado en cama con luz natural (00:00)
2. E entra y cierra cortinas (luz reduce ~50%) (00:30)
3. R1 permanece acostado (01:00 - 02:00)
4. E abre cortinas (luz aumenta) (02:00)
5. R1 contin√∫a acostado (02:30 - 03:00)

**Resultado Esperado:**
- ‚úÖ Track R1 se mantiene durante cambios de luz
- ‚úÖ No se pierde track al reducir iluminaci√≥n
- ‚úÖ Confidence puede variar pero track persiste

**Checklist de Validaci√≥n:**
```
[ ] Track no se resetea al cerrar cortinas
[ ] Track no se resetea al abrir cortinas
[ ] Confidence puede bajar pero >= persist_threshold (0.3)
```

---

## üìä Matriz de Validaci√≥n Final

Al completar todos los test cases, completar esta matriz:

| Test Case | Status | Tracks OK | Ca√≠da Detectada | ID Correcto | Notas |
|-----------|--------|-----------|-----------------|-------------|-------|
| TC-001 | ‚¨ú | ‚¨ú | N/A | N/A | |
| TC-002 | ‚¨ú | ‚¨ú | N/A | N/A | |
| TC-003 | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | |
| TC-004 | ‚¨ú | ‚¨ú | N/A | N/A | |
| TC-005 | ‚¨ú | ‚¨ú | N/A | N/A | |
| TC-006 | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚≠ê CR√çTICO |
| TC-007 | ‚¨ú | ‚¨ú | N/A | N/A | |
| TC-008 | ‚¨ú | ‚¨ú | N/A | N/A | |
| TC-009 | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚≠ê‚≠ê‚≠ê M√ÅS CR√çTICO |
| TC-010 | ‚¨ú | ‚¨ú | N/A | N/A | |
| TC-011 | ‚¨ú | ‚¨ú | N/A | N/A | |
| TC-012 | ‚¨ú | ‚¨ú | N/A | N/A | |

**Leyenda:**
- ‚úÖ = Aprobado
- ‚ö†Ô∏è = Aprobado con observaciones
- ‚ùå = Fallido

---

## üìπ Registro de Evidencias

Para cada test case, registrar:

1. **Video del escenario** (c√°mara externa o grabaci√≥n de pantalla)
2. **Logs del sistema** (copiar output de terminals)
3. **Screenshots MQTT monitor** (cuando sea relevante)
4. **Timestamp de eventos cr√≠ticos** (entradas, salidas, ca√≠das)

**Estructura de carpetas sugerida:**
```
testing_YYYYMMDD/
‚îú‚îÄ‚îÄ TC-001/
‚îÇ   ‚îú‚îÄ‚îÄ video.mp4
‚îÇ   ‚îú‚îÄ‚îÄ logs.txt
‚îÇ   ‚îú‚îÄ‚îÄ mqtt_output.txt
‚îÇ   ‚îî‚îÄ‚îÄ notas.md
‚îú‚îÄ‚îÄ TC-002/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ resumen_final.md
```

---

## üö® Criterios de √âxito/Falla

**Recordatorio:** Adeline v2.1 valida **fundamentos de multi-tracking**, NO eventos espec√≠ficos (v3.0+)

### ‚úÖ √âxito Global (v2.1 Release Ready)

**Fundamentos de Multi-Tracking Validados:**
- [ ] **TC-006 APROBADO** - 2 tracks diferenciados, cambio de bbox identificable
- [ ] **TC-009 APROBADO** - 4 tracks diferenciados, cambio de bbox identificable
- [ ] **>= 10/12 test cases aprobados**
- [ ] **No regressions** vs comportamiento sin IoU (TC-001 a TC-003)
- [ ] **Track IDs estables** - No swaps, no resets inesperados
- [ ] **IoU threshold 0.3 funciona** - No fusiones incorrectas

**Significa:**
‚Üí Fundamento s√≥lido para implementar event detection (Bed Exit, Patient Fall, etc.) en v3.0

### ‚ö†Ô∏è √âxito Parcial (Requiere ajustes antes de Release)

- [ ] TC-006 o TC-009 con warnings (funciona pero no √≥ptimo)
- [ ] 8-9/12 test cases aprobados
- [ ] Tracking funciona pero requiere ajustar `iou_threshold` (0.2-0.5)
- [ ] Tracks se fusionan ocasionalmente (< 10% de los casos)

**Acci√≥n:**
‚Üí Ajustar par√°metros (iou_threshold, min_frames, max_gap) y re-test

### ‚ùå Falla Cr√≠tica (No Release - Requiere Debugging)

- [ ] TC-006 o TC-009 fallidos consistentemente
- [ ] < 8/12 test cases aprobados
- [ ] Regressions vs versi√≥n anterior (sin IoU)
- [ ] Track IDs cambian constantemente (swaps frecuentes)
- [ ] Tracks se fusionan frecuentemente (> 20% de los casos)

**Acci√≥n:**
‚Üí Revisar implementaci√≥n de IoU, posibles bugs en matching logic

---

## üîß Troubleshooting Durante Testing

### Problema: Tracks se fusionan incorrectamente

**Soluci√≥n:**
```yaml
# Aumentar threshold en config.yaml
iou:
  threshold: 0.4  # De 0.3 ‚Üí 0.4 (m√°s estricto)
```

### Problema: Tracks duplicados para misma persona

**Soluci√≥n:**
```yaml
# Reducir threshold
iou:
  threshold: 0.2  # De 0.3 ‚Üí 0.2 (m√°s permisivo)
```

### Problema: Tracks se pierden f√°cilmente

**Soluci√≥n:**
```yaml
# Aumentar tolerancia de gap
temporal:
  max_gap: 3  # De 2 ‚Üí 3 frames
```

### Problema: Demasiados false positives

**Soluci√≥n:**
```yaml
# Aumentar frames requeridos
temporal:
  min_frames: 4  # De 3 ‚Üí 4 frames
```

---

## üìû Contacto T√©cnico Durante Testing

**Operador T√©cnico (OT):** [Nombre]
**Tel√©fono:** [N√∫mero]
**Email:** [Email]

**En caso de crash del sistema:**
1. Guardar logs inmediatamente
2. Reiniciar sistema
3. Continuar con siguiente test case
4. Reportar incidente al final

---

## ‚úÖ Firma de Validaci√≥n

**Test Ejecutado por:**
- Nombre: ________________
- Fecha: ________________
- Firma: ________________

**Test Validado por:**
- Nombre: ________________ (Operador T√©cnico)
- Fecha: ________________
- Firma: ________________

---

## üöÄ Roadmap: De v2.1 (Multi-Tracking) hacia v3.0 (Event Detection)

**Si v2.1 testing es exitoso** (IoU multi-tracking validado), el siguiente paso es agregar una **capa de l√≥gica de eventos** encima del tracking.

### Eventos de Verso Vision - Viabilidad con Fundamento v2.1

| Evento | Requiere | Viabilidad v3.0 | Esfuerzo |
|--------|----------|-----------------|----------|
| **Extra Person In Room** | Conteo de tracks | ‚úÖ F√°cil | 1-2 d√≠as |
| **Patient Fall** | Aspect ratio + y_center change | ‚úÖ Medio | 3-5 d√≠as |
| **Room Exit** | Zone tracking + track persistence | ‚úÖ Medio | 3-5 d√≠as |
| **Bed Exit** | Zone (bed) + track movement | üü° Medio-Alto | 5-7 d√≠as |
| **Leaving Bed** | Zone + pose estimation | üü° Alto | 1-2 semanas |
| **Bathroom Entry** | Zone (bathroom door) | ‚úÖ Medio | 3-5 d√≠as |
| **Bathroom Timer** | Zone + time tracking per track | ‚úÖ Medio | 3-5 d√≠as |
| **Leaving Chair** | Zone + pose estimation | üü° Alto | 1-2 semanas |
| **Out of View (Hiding)** | Spatial reasoning + zones | üü° Alto | 1-2 semanas |

### Arquitectura Propuesta v3.0 (Event Detection Layer)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Event Detection Layer (v3.0)             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Event Handlers (KISS - uno por evento)    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - PatientFallHandler                     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - ExtraPersonHandler                     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - BedExitHandler                         ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - BathroomTimerHandler                   ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                    ‚Üì consume tracks              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    Multi-Object Tracking (v2.1 - VALIDADO)      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ IoU Matching                              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ Track persistence (min_frames, max_gap)   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ Track ID stability                        ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                    ‚Üì produce tracks              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Person Detection (base - actual)         ‚îÇ
‚îÇ  YOLO ‚Üí Bounding Boxes                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Ejemplo: Implementaci√≥n "Patient Fall" Event (v3.0)

```python
# inference/events/patient_fall.py
class PatientFallHandler(BaseEventHandler):
    """
    Detecta ca√≠das mediante an√°lisis de cambios en tracks.

    Algoritmo KISS:
    1. Para cada track activo, calcular aspect_ratio (height/width)
    2. Si aspect_ratio cambia dr√°sticamente (1.5 ‚Üí 0.7) en <2s ‚Üí Ca√≠da
    3. Si y_center aumenta significativamente ‚Üí Confirma ca√≠da
    4. Emitir evento con track_id
    """

    def __init__(self, aspect_ratio_threshold=0.6, time_window=2.0):
        self.aspect_ratio_threshold = aspect_ratio_threshold
        self.time_window = time_window
        self.track_history = defaultdict(deque)  # track_id -> history

    def process(self, tracks: List[DetectionTrack]) -> List[Event]:
        events = []

        for track in tracks:
            # Calcular aspect ratio actual
            current_ratio = track.height / track.width if track.width > 0 else 0

            # Guardar en historia
            self.track_history[track.id].append({
                'timestamp': time.time(),
                'aspect_ratio': current_ratio,
                'y_center': track.y,
            })

            # Analizar cambios en ventana de tiempo
            history = self.track_history[track.id]
            if len(history) >= 2:
                first = history[0]
                last = history[-1]

                time_delta = last['timestamp'] - first['timestamp']
                ratio_delta = first['aspect_ratio'] - last['aspect_ratio']
                y_delta = last['y_center'] - first['y_center']

                # Detecci√≥n: ratio cambi√≥ dr√°sticamente (vertical ‚Üí horizontal)
                #            y aument√≥ (persona baj√≥ en frame)
                #            en ventana de tiempo corta
                if (ratio_delta > self.aspect_ratio_threshold and
                    y_delta > 0.1 and
                    time_delta < self.time_window):

                    events.append(Event(
                        type='patient_fall',
                        track_id=track.id,
                        timestamp=last['timestamp'],
                        confidence=track.confidence,
                        metadata={
                            'aspect_ratio_before': first['aspect_ratio'],
                            'aspect_ratio_after': last['aspect_ratio'],
                            'fall_duration': time_delta,
                        }
                    ))

                    logger.warning(
                        f"üö® PATIENT FALL DETECTED - Track {track.id} "
                        f"(ratio {first['aspect_ratio']:.2f} ‚Üí {last['aspect_ratio']:.2f})"
                    )

        return events
```

### KISS Approach para v3.0

**Filosof√≠a:** Complejidad por dise√±o, no c√≥digo complicado

1. **Un handler por evento** (SRP - Single Responsibility)
2. **L√≥gica simple** (aspect ratio, zones, conteo)
3. **Configurable** (thresholds en config.yaml)
4. **Factory pattern** (igual que stabilization)
5. **Testing incremental** (un evento a la vez)

**Orden de implementaci√≥n sugerido (v3.0):**
```
Sprint 1: Extra Person In Room (m√°s f√°cil - solo conteo)
Sprint 2: Patient Fall (aspect ratio logic)
Sprint 3: Room Exit (zone tracking)
Sprint 4: Bathroom Timer (zone + time tracking)
Sprint 5+: Eventos complejos (pose estimation, etc.)
```

---

## üìû Preguntas para Planificaci√≥n v3.0

**Despu√©s de completar testing v2.1, discutir con equipo:**

1. **¬øQu√© evento es m√°s cr√≠tico para lanzar primero?**
   - Patient Fall (seguridad)
   - Extra Person In Room (privacidad)
   - Bathroom Timer (independencia)

2. **¬øTenemos ground truth data para validar eventos?**
   - Videos etiquetados con ca√≠das reales
   - Videos con m√∫ltiples personas
   - Videos con bathroom timers

3. **¬øQu√© precisi√≥n m√≠nima se necesita para producci√≥n?**
   - 90% precision (¬øcu√°ntos falsos positivos son aceptables?)
   - 95% recall (¬øcu√°ntas ca√≠das NO pueden perderse?)

4. **¬øNecesitamos pose estimation?**
   - Si s√≠ ‚Üí Evaluar modelos (MediaPipe, OpenPose, YOLO-Pose)
   - Si no ‚Üí Implementar solo eventos basados en bboxes

---

**Fin del Documento de Test Cases Funcionales v1.0**
